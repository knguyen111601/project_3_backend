//////////////////////////////////////////////////////////////////////
// Import Our Dependencies
//////////////////////////////////////////////////////////////////////
require("dotenv").config()
const express = require("express")
const mongoose = require("./db/connection")
const morgan = require("morgan")
const cors = require("cors")
const app = express();
const {PORT = 7771} = process.env
const auth = require("./auth")

// Import Router
const WishlistRouter = require("./controllers/wishlist")
const AuthRouter = require("./controllers/user")
//////////////////////////////////////////////////////////////////////
// Middleware 
//////////////////////////////////////////////////////////////////////
app.use(cors()) // prevent cors errors, opens up access for frontend
app.use(morgan("dev")) // logging
app.use(express.json()) // parse json bodies

//////////////////////////////////////////////////////////////////////
// Routes
//////////////////////////////////////////////////////////////////////
// app.get("/", auth, (req,res)=>{
//     res.json(req.payload)
// })

app.use("/", WishlistRouter)

app.use("/auth", AuthRouter)

//////////////////////////////////////////////////////////////////////
// Server Listener
//////////////////////////////////////////////////////////////////////
app.listen(PORT, ()=>{console.log(`Now listening on PORT ${PORT}`)})